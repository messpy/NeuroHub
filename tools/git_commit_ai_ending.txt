# ===== å¾Œå‡¦ç† =====
echo
log "âœ… AI ã‚³ãƒŸãƒƒãƒˆå®Œäº†"

# PRä½œæˆã‚µãƒãƒ¼ãƒˆ
if $CREATE_PR; then
  current_branch="$(git branch --show-current 2>/dev/null || echo "main")"
  if [[ "$current_branch" != "main" && "$current_branch" != "master" ]]; then
    echo
    echo "======================================="
    echo "ğŸ”— PRä½œæˆãƒªãƒ³ã‚¯"
    if git remote get-url origin >/dev/null 2>&1; then
      repo_url="$(git remote get-url origin 2>/dev/null || echo "")"
      repo_url="${repo_url%.git}"
      repo_url="${repo_url#git@github.com:}"
      if [[ "$repo_url" != http* ]]; then
        repo_url="https://github.com/$repo_url"
      fi
      echo "open \"$repo_url/compare/$current_branch?expand=1\""
    fi
    echo "======================================="

    if command -v gh >/dev/null 2>&1; then
      read -r -p "GitHub CLIã§PRã‚’ä½œæˆã—ã¾ã™ã‹ï¼Ÿ [y/N] " ans
      if [[ "${ans,,}" == "y" ]]; then
        gh pr create --title "AI Generated: $current_branch" --body "AI generated commits from git_commit_ai tool"
      fi
    fi
  else
    log "ãƒ¡ã‚¤ãƒ³ãƒ–ãƒ©ãƒ³ãƒã®ãŸã‚PRä½œæˆã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¾ã—ãŸ"
  fi
fi

log "å®Œäº†"
